<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>AutoChess MMR Tool</title>
<style>
  /* Stil aynı */
  body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; color: #222; }
  h1,h2 { text-align: center; color: #333; }
  #steamId { padding: 8px; width: 250px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc; }
  button { padding: 8px 12px; font-size: 16px; border-radius: 5px; background: #333; color: white; border:none; cursor:pointer; }
  button:hover { background: #555; }
  .username { text-align: center; font-weight: bold; font-size: 22px; padding: 15px 20px; margin-bottom: 15px; }
  .stats-container { display: flex; justify-content: center; gap: 15px; flex-wrap: nowrap; overflow-x: auto; background: white; border-radius: 0 0 5px 5px; padding: 15px 20px; box-shadow: 0 1px 5px rgba(0,0,0,0.1); }
  .stat-box { background: #f9f9f9; border: 1px solid #ddd; padding: 12px 15px; border-radius: 5px; font-size: 16px; min-width: 130px; text-align: center; white-space: nowrap; }
  table { width: 100%; border-collapse: collapse; margin-top: 30px; background: white; border-radius: 5px; box-shadow: 0 1px 5px rgba(0,0,0,0.1); overflow: hidden;}
  th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: center; }
  th { background: #333; color: white; }
  .rank { font-weight: bold; color: #222; }
  .username-cell { text-align: center; color: #222; }
  tbody tr:hover { background: #f0f0f0; cursor: default; }
</style>
</head>
<body>

<h1>DAC MMR Search</h1>
<input type="text" id="steamId" placeholder="Steam ID or Username" />
<button onclick="getSteamDetails()">Search</button>

<div id="result" style="display:none;">
  <div class="username" id="usernameDisplay"></div>
  <div class="stats-container" id="statsContainer"></div>
</div>

<div>
  <h2>Streamers</h2>
  <table>
    <thead>
      <tr>
        
        <th>Username</th>
        <th>Current MMR</th>
        <th>Maximum MMR</th>
        <th>Games Played</th>
        <th>Wins</th>
        <th>Candy</th>
        <th>Donut</th>
        <th>Stream Link</th>
      </tr>
    </thead>
    <tbody id="top20List">
      <tr><td colspan="9" style="text-align:center;">Loading...</td></tr>
    </tbody>
  </table>
</div>

<script>
  // Oyuncu listesi, her oyuncuya steamId ve stream linkiyle beraber
  const players = [
    { name: 'el_Clasic0', steamId: 'el_Clasic0', stream: 'https://www.twitch.tv/el_clasic0' },
    { name: '1heFancyPants', steamId: '1heFancyPants', stream: 'https://www.twitch.tv/1hefancypants' },
    { name: 'miguelxdd199', steamId: '76561199426706539', stream: 'https://www.twitch.tv/miguelxdd199' },
    { name: 'oliyoun', steamId: '76561197963364255', stream: 'https://www.twitch.tv/oliyoun' },
    { name: 'dumpstered', steamId: '76561198068629460', stream: 'https://www.twitch.tv/dumpstered95' },
    { name: 'envy', steamId: 'toms1', stream: 'https://www.twitch.tv/envy_chilling' },
    { name: 'timer', steamId: 't1mer_tv', stream: 'https://www.twitch.tv/t1mer_tv' },
    { name: 'serbian', steamId: '76561198026902925', stream: 'https://www.twitch.tv/serbianbutcher95' },
    { name: 'corekid', steamId: '76561198204336531', stream: 'https://www.twitch.tv/corekid94' },
    { name: 'loyrens', steamId: 'loyrens', stream: 'https://www.twitch.tv/loyrensss' },
    { name: 'moxiaomo', steamId: '76561198404719293', stream: 'https://www.douyu.com/48261' },
    { name: 'dark', steamId: '76561198409982279', stream: '-' },
    { name: 'crazypanda', steamId: '76561198252405606', stream: 'https://www.twitch.tv/crazyyypanda' },
    { name: 'tenevoi', steamId: '76561198254014950', stream: 'https://www.twitch.tv/tenevoi059' },
    { name: 'energywibe', steamId: 'energywibe', stream: 'https://www.twitch.tv/energywibe' },
    { name: 'dielikezombie', steamId: '76561198149083676', stream: 'https://www.twitch.tv/dielikezombie' },
    { name: 'keeldawg', steamId: 'keeldawg', stream: 'https://www.twitch.tv/keeldawg' },
    { name: 'dendorn', steamId: '76561198059079234', stream: 'https://www.twitch.tv/dendorn' },
    { name: 'youdontknowme', steamId: '76561199037135619', stream: 'https://www.twitch.tv/iyoudontknowme' },
    { name: 'nightcall', steamId: '76561198166612860', stream: 'https://www.twitch.tv/nightcall333' },
    { name: 'anhedonia', steamId: 'Pamdiracsbrain', stream: 'https://www.twitch.tv/anhedoniia' },
    { name: 'mecasu', steamId: 'mecasu', stream: 'https://www.twitch.tv/mecasu' }
  ];

  // Sunucudan veri çekme fonksiyonu
  async function fetchPlayerData(steamId) {
    try {
      const response = await fetch(`https://workers-playground-floral-field-cde5.melihcansunay.workers.dev/?steamId=${steamId}`);
      if (!response.ok) throw new Error(`Server Error: ${response.status}`);

      const text = await response.text();
      const values = text.trim().split('|');

      if (values.length < 7) throw new Error('Missing data');

      return {
        username: values[0],
        mmr_s37: values[1],
        max_mmr_s37: values[2],
        match_s37: values[3],
        chicken_count: values[4],
        candy: values[5],
        biscuit: values[6]
      };
    } catch(e) {
      console.error(`Error (${steamId}): ${e.message}`);
      return {
        username: steamId,
        mmr_s37: '-',
        max_mmr_s37: '-',
        match_s37: '-',
        chicken_count: '-',
        candy: '-',
        biscuit: '-'
      };
    }
  }

  async function loadTop20() {
    const tbody = document.getElementById('top20List');
    tbody.innerHTML = '<tr><td colspan="9" style="text-align:center;">Loading...</td></tr>';

    // SteamID'ye göre sırayla veri çek
    const results = await Promise.all(players.map(p => fetchPlayerData(p.steamId)));

    // Sonuçları mmr_s37'ye göre azalan sırala
    const sorted = results.map((data, idx) => ({
      ...data,
      stream: players[idx].stream
    })).sort((a,b) => {
      const aMMR = parseInt(a.mmr_s37);
      const bMMR = parseInt(b.mmr_s37);
      if (isNaN(aMMR)) return 1;
      if (isNaN(bMMR)) return -1;
      return bMMR - aMMR;
    });

    tbody.innerHTML = sorted.map((p,i) => {
      const twitchIcon = `
  <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="#9146FF" style="display:block;">
    <path d="M2 2v16h4v4l4-4h6l4-4V2H2zm16 10-4 4h-6l-2 2v-2H4V4h14v8z"/>
    <path d="M14 7h1v5h-1zM10 7h1v5H10z"/>
  </svg>
`;

const streamLink = (p.stream && p.stream !== '-') ? `<a href="${p.stream}" target="_blank" rel="noopener noreferrer" title="Watch Stream">${twitchIcon}</a>` : '-';

      return `
        <tr>
          
          <td class="username-cell" title="${p.username}">${p.username}</td>
          <td>${p.mmr_s37}</td>
          <td>${p.max_mmr_s37}</td>
          <td>${p.match_s37}</td>
          <td>${p.chicken_count}</td>
          <td>${p.candy}</td>
          <td>${p.biscuit}</td>
    <td style="display: flex; justify-content: center; align-items: center;">
  ${streamLink}
</td>

        </tr>
      `;
    }).join('');
  }

  loadTop20();

  async function getSteamDetails() {
    const steamId = document.getElementById('steamId').value.trim();
    const resultDiv = document.getElementById('result');
    const usernameDisplay = document.getElementById('usernameDisplay');
    const statsContainer = document.getElementById('statsContainer');

    if (!steamId) {
      resultDiv.style.display = 'block';
      usernameDisplay.textContent = '';
      statsContainer.innerHTML = '<div class="stat-box">Please enter a Steam username or ID.</div>';
      return;
    }

    try {
      const response = await fetch(`https://workers-playground-floral-field-cde5.melihcansunay.workers.dev/?steamId=${steamId}`);
      if (!response.ok) throw new Error(`Server error: ${response.status}`);

      const text = await response.text();
      const values = text.trim().split('|');

      if (values.length < 7) throw new Error('Missing data');

      const [username, mmr_s37, max_mmr_s37, match_s37, chicken_count, candy, biscuit] = values;

      usernameDisplay.textContent = `Username: ${username}`;
      const labels = ['Current MMR','Maximum MMR','Game Played','Wins','Candy','Donut'];
      const data = [mmr_s37, max_mmr_s37, match_s37, chicken_count, candy, biscuit];

      statsContainer.innerHTML = labels.map((label, i) =>
        `<div class="stat-box">${label}: ${data[i]}</div>`
      ).join('');

    } catch (error) {
      usernameDisplay.textContent = '';
      statsContainer.innerHTML = `<div class="stat-box">Error: ${error.message}</div>`;
    }

    resultDiv.style.display = 'block';
  }
</script>
<footer style="
  text-align:center; 
  padding:15px 0; 
  background:#333; 
  color:#fff; 
  margin-top:30px; 
  font-size:14px;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 15px;
  white-space: nowrap;
  overflow-x: visible;
">
  © 2025 AutoChess MMR Tool - made by Mecasu - Contact: 
 <a href="https://www.twitch.tv/mecasu" target="_blank" rel="noopener noreferrer" style="display:flex; align-items:center; gap: 5px;">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24" fill="#FFFFFF" style="display:block;">
  <path d="M2 2v16h4v4l4-4h6l4-4V2H2zm16 10-4 4h-6l-2 2v-2H4V4h14v8z"/>
  <path d="M14 7h1v5h-1zM10 7h1v5H10z"/>
</svg>

  </a>
  <a href="mailto:melihcansunay@gmail.com" style="display:flex; align-items:center;" title="Send Email">
    <svg xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF" viewBox="0 0 24 24" width="24" height="24" style="display:block;">
      <path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
    </svg>
  </a>
</footer>






</body>
</html>
